(function(){var i;i=function(){function i(i,t,e,o){return{restrict:"E",scope:!0,templateUrl:"/imago/imago-virtual-list.html",transclude:!0,controller:function(){},controllerAs:"imagovirtuallist",bindToController:{data:"=",onBottom:"&",scroll:"=",offsetBottom:"@",uuid:"@"},link:function(l,r,n,a,s){var u,c,d;return s(l,function(i){return r.children().append(i)}),c={},c.scrollTop=0,c.browserKey=("undefined"!=typeof bowser&&null!==bowser?bowser.safari:void 0)<=8?"-webkit-transform":"transform",c.uuid=l.imagovirtuallist.uuid||"id",l.imagovirtuallist.offsetBottom||(l.imagovirtuallist.offsetBottom=i.innerHeight),u=document.createElement("div"),u.id="master-item",u.className=n.classItem,u.style.opacity=0,u.style.zIndex=-1,r.append(u),l.init=function(){return c.initRunning?void 0:(c.initRunning=!0,l.visibleProvider=[],o(function(){var t;return c.divWidth=u.clientWidth,c.divHeight=u.clientHeight,c.itemsPerRow=Math.floor(r[0].clientWidth/c.divWidth),t=Math.round(i.innerHeight/c.divHeight),c.cellsPerPage=t*c.itemsPerRow,c.numberOfCells=3*c.cellsPerPage,c.itemsPerRow>1?c.canvasWidth=c.itemsPerRow*c.divWidth:c.canvasWidth=null,c.updateData(),c.initRunning=!1},200))},c.updateData=function(){return l.imagovirtuallist.data?(c.canvasHeight=Math.ceil(l.imagovirtuallist.data.length/c.itemsPerRow)*c.divHeight,l.canvasStyle={height:c.canvasHeight+"px",width:c.canvasWidth+"px"},c.updateDisplayList()):void 0},c.updateDisplayList=function(){var t,e,o,r,n,a,s,u;for(n=Math.max(Math.round(c.scrollTop/c.divHeight)-Math.round(i.innerHeight/c.divHeight),0),t=Math.min(n+c.numberOfCells,c.numberOfCells),o=n*c.itemsPerRow,l.visibleProvider=l.imagovirtuallist.data.slice(o,o+t),e=_.chunk(l.visibleProvider,c.itemsPerRow),a=0,u=l.visibleProvider.length;u>a;)r=function(){var i,t,o,r,n,s,u,d,v;for(o=s=0,d=e.length;d>s;o=++s)for(i=e[o],r=u=0,v=i.length;v>u;r=++u)if(n=i[r],n[c.uuid]===l.visibleProvider[a][c.uuid])return t={chunk:o,inside:r}},s=r(),l.visibleProvider[a].styles={},l.visibleProvider[a].styles[c.browserKey]="translate("+(c.divWidth*s.inside+"px")+", "+((n+s.chunk)*c.divHeight+"px")+")",a++;return l.imagovirtuallist.scroll?l.scroll():void 0},l.scroll=function(){return l.imagovirtuallist.scroll?o(function(){return c.scrollTop=angular.copy(l.imagovirtuallist.scroll),l.imagovirtuallist.scroll=0,t.scrollTop(c.scrollTop,0)}):void 0},l.onScroll=function(){return c.scrollTop=i.scrollY||i.pageYOffset,c.canvasHeight-c.scrollTop<=Number(l.imagovirtuallist.offsetBottom)&&l.imagovirtuallist.onBottom(),c.updateDisplayList(),l.$digest()},l.init(),l.$watch("imagovirtuallist.data",function(i){return c.updateData()}),angular.element(i).on("resize",function(){return Math.floor(r[0].clientWidth/u.clientWidth)!==c.itemsPerRow?l.init():void 0}),angular.element(i).on("scroll",l.onScroll),d=[],d.push(e.$on("imagovirtuallist:init",function(){return l.init()})),l.$on("$destroy",function(){var t,e,o,r;for(angular.element(i).off("scroll",l.onScroll),o=[],t=0,e=d.length;e>t;t++)r=d[t],o.push(r());return o})}}}return i}(),angular.module("imago").directive("imagoVirtualList",["$window","$document","$rootScope","$timeout",i])}).call(this),angular.module("imago").run(["$templateCache",function(i){i.put("/imago/imago-virtual-list.html",'<div ng-style="canvasStyle" class="imago-virtual-list-content"></div>')}]);