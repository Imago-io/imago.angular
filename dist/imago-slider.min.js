var imagoSlider,imagoSliderController,bind=function(e,r){return function(){return e.apply(r,arguments)}};imagoSlider=function(){function e(e,r,t,i,n){return{transclude:!0,scope:!0,templateUrl:"/imago/imago-slider.html",controller:"imagoSliderController as imagoslider",bindToController:{assets:"=?imagoSlider"},link:function(n,s,o,a,l){var u,d;return l(n,function(e){return s.children().children().eq(0).append(e)}),d=[],n.$watchCollection("imagoslider.assets",function(e){return e&&_.isArray(e)?(n.imagoslider.length=e.length,n.imagoslider.init(),n.prefetch("initial")):void 0}),n.setSiblings=function(){return n.imagoslider.opts.siblings=!(!n.imagoslider.opts.next||!n.imagoslider.opts.prev)},n.setSiblings(),angular.isDefined(o.prev)&&o.$observe("prev",function(){return n.imagoslider.opts.prev=o.prev,n.setSiblings()}),angular.isDefined(o.next)&&o.$observe("next",function(){return n.imagoslider.opts.next=o.next,n.setSiblings()}),i.path().indexOf("last")?n.currentIndex=parseInt(n.imagoslider.opts.current):n.currentIndex=n.getLast(),n.clearInterval=function(){return n.imagoslider.opts.interval?t.cancel(n.imagoslider.opts.interval):void 0},n.imagoslider.goPrev=function(e){return"object"==typeof e&&(n.clearInterval(),e.stopPropagation()),n.imagoslider.opts.loop?n.imagoslider.opts.loop&&!n.imagoslider.opts.siblings?n.imagoslider.setCurrent(n.currentIndex>0?n.currentIndex-1:parseInt(n.imagoslider.length)-1):n.imagoslider.opts.loop&&n.imagoslider.opts.siblings&&(n.currentIndex>0?n.imagoslider.setCurrent(n.currentIndex-1):i.path(n.imagoslider.opts.prev)):n.imagoslider.setCurrent(n.currentIndex>0?n.currentIndex-1:n.currentIndex),n.prefetch("prev")},n.imagoslider.goNext=function(e){return function(e,r){return null==r&&(r=!0),("object"==typeof e||r)&&(n.clearInterval(),e&&e.stopPropagation()),n.imagoslider.opts.loop?n.imagoslider.opts.loop&&!n.imagoslider.opts.siblings?n.imagoslider.setCurrent(n.currentIndex<n.imagoslider.length-1?n.currentIndex+1:0):n.imagoslider.opts.loop&&n.imagoslider.opts.siblings&&(n.currentIndex<n.imagoslider.length-1?n.imagoslider.setCurrent(n.currentIndex+1):i.path(n.imagoslider.opts.next)):n.imagoslider.setCurrent(n.currentIndex<n.imagoslider.length-1?n.currentIndex+1:n.currentIndex),n.prefetch("next")}}(this),n.prefetch=function(e){var r,t,i,s;if(n.imagoslider.opts.prefetch&&(null!=(i=n.imagoslider.assets)?i.length:void 0)&&(n.currentIndex===n.getLast()?r=0:"initial"===e?r=1:"prev"===e?r=angular.copy(n.currentIndex)-1:"next"===e&&(r=angular.copy(n.currentIndex)+1),(null!=(s=n.imagoslider.assets[r])?s.serving_url:void 0)&&n.imagoslider.servingSize))return t=new Image,t.src=n.imagoslider.assets[r].serving_url+n.imagoslider.servingSize},n.getLast=function(){return Number(n.imagoslider.length)-1},n.getCurrent=function(){return n.currentIndex},n.imagoslider.setCurrent=function(r){return n.action=function(){switch(!1){case!(0===r&&n.currentIndex===parseInt(this.length)-1&&!n.imagoslider.opts.siblings):return"next";case!(r===parseInt(this.length)-1&&0===n.currentIndex&&!n.imagoslider.opts.siblings):return"prev";case!(r>n.currentIndex):return"next";case!(r<n.currentIndex):return"prev";default:return""}}.call(this),void 0===r?this.goNext():(n.currentIndex=r,e.$emit(n.imagoslider.opts.namespace+":changed",r))},_.isUndefined(o.autoplay)||n.$watch(o.autoplay,function(e){return function(e){return parseInt(e)>0?n.imagoslider.opts.interval=t(function(){return n.imagoslider.goNext("",!1)},parseInt(e)):n.clearInterval()}}(this)),u=function(e){switch(e.keyCode){case 37:return n.$apply(function(){return n.imagoslider.goPrev()});case 39:return n.$apply(function(){return n.imagoslider.goNext()})}},n.imagoslider.opts.enablekeys&&r.on("keydown",u),d.push(e.$on(n.imagoslider.opts.namespace+":change",function(e,r){return n.clearInterval(),n.imagoslider.setCurrent(r)})),n.$on("$destroy",function(){var e,t,i,s;for(r.off("keydown",u),n.clearInterval(),i=[],e=0,t=d.length;t>e;e++)s=d[e],i.push(s());return i})}}}return e}(),imagoSliderController=function(){function e(e,r,t){var i,n;this.$scope=e,this.$attrs=r,this.$element=t,this.setServingSize=bind(this.setServingSize,this),this.opts={animation:"fade",enablekeys:!0,enablearrows:!0,loop:!0,current:0,namespace:"slider",autoplay:0,next:null,prev:null,prefetch:!0};for(i in this.$attrs)this.opts[i]&&("true"===(n=this.$attrs[i])||"false"===n?this.opts[i]=JSON.parse(this.$attrs[i]):isNaN(this.$attrs[i])?this.opts[i]=this.$attrs[i]:this.opts[i]=Number(this.$attrs[i]))}return e.prototype.init=function(){return this.slider=new Swiper(this.$element.children(),{loop:!0,initialSlide:0,showNavButtons:!0,slidesPerView:1,slidesPerColumn:1,lazyLoading:!0,preloadImages:!1,spaceBetween:0,direction:"horizontal",pagination:".swiper-pagination",nextButton:".swiper-button-next",prevButton:".swiper-button-prev"}),this.slider.on("slideChangeStart",function(e){return function(){return e.goNext()}}(this))},e.prototype.setServingSize=function(e){return this.servingSize?this.servingSize=e:(this.servingSize=e,this.$scope.prefetch("initial"))},e}(),angular.module("imago").directive("imagoSlider",["$rootScope","$document","$interval","$location","$timeout",imagoSlider]).controller("imagoSliderController",["$scope","$attrs","$element",imagoSliderController]),angular.module("imago").run(["$templateCache",function(e){e.put("/imago/imago-slider.html",'<div class="swiper-container"><div class="swiper-wrapper"></div><div class="swiper-pagination"></div><div class="swiper-button-prev"></div><div class="swiper-button-next"></div><div class="swiper-scrollbar"></div></div>')}]);