!function(){var e=function(c,g,d,u){return{restrict:"E",transclude:!0,scope:!0,templateUrl:"/imago/imago-slider.html",controller:"imagoSliderController as imagoslider",bindToController:{assets:"=?data"},link:function(t,n,e,r,i){var o,a,s,l;for(o in i(t,function(e){return n.children().append(e)}),e)s=e[o],"$"!==o.charAt(0)&&("true"!==s&&"false"!==s||(s=JSON.parse(s)),t.imagoslider.conf[o]=s);return t.$watchCollection("imagoslider.assets",function(e){if(e&&_.isArray(e))return t.imagoslider.length=e.length,t.prefetch("initial")}),t.setSiblings=function(){return t.imagoslider.conf.siblings=!(!t.imagoslider.conf.next||!t.imagoslider.conf.prev)},t.setSiblings(),angular.isDefined(e.prev)&&e.$observe("prev",function(){return t.imagoslider.conf.prev=e.prev,t.setSiblings()}),angular.isDefined(e.next)&&e.$observe("next",function(){return t.imagoslider.conf.next=e.next,t.setSiblings()}),u.path().indexOf("last")?t.currentIndex=parseInt(t.imagoslider.conf.current):t.currentIndex=t.getLast(),t.clearInterval=function(){if(t.imagoslider.conf.interval)return d.cancel(t.imagoslider.conf.interval)},t.imagoslider.goPrev=function(e){return"object"==typeof e&&(t.clearInterval(),e.stopPropagation()),t.imagoslider.conf.loop?(t.imagoslider.conf.loop,t.imagoslider.conf.siblings?t.imagoslider.conf.loop&&t.imagoslider.conf.siblings&&(0<t.currentIndex?t.imagoslider.setCurrent(t.currentIndex-1):u.path(t.imagoslider.conf.prev)):t.imagoslider.setCurrent(0<t.currentIndex?t.currentIndex-1:parseInt(t.imagoslider.length)-1)):t.imagoslider.setCurrent(0<t.currentIndex?t.currentIndex-1:t.currentIndex),t.prefetch("prev")},t.imagoslider.goNext=function(e,n){return null==n&&(n=!0),("object"==typeof e||n)&&(t.clearInterval(),e)&&e.stopPropagation(),t.imagoslider.conf.loop?(t.imagoslider.conf.loop,t.imagoslider.conf.siblings?t.imagoslider.conf.loop&&t.imagoslider.conf.siblings&&(t.currentIndex<t.imagoslider.length-1?t.imagoslider.setCurrent(t.currentIndex+1):u.path(t.imagoslider.conf.next)):t.imagoslider.setCurrent(t.currentIndex<t.imagoslider.length-1?t.currentIndex+1:0)):t.imagoslider.setCurrent(t.currentIndex<t.imagoslider.length-1?t.currentIndex+1:t.currentIndex),t.prefetch("next")},t.prefetch=function(e){var n,r;if(t.imagoslider.conf.prefetch&&null!=(r=t.imagoslider.assets)&&r.length&&(t.currentIndex===t.getLast()?n=0:"initial"===e?n=1:"prev"===e?n=angular.copy(t.currentIndex)-1:"next"===e&&(n=angular.copy(t.currentIndex)+1),null!=(r=t.imagoslider.assets[n]))&&r.serving_url&&t.imagoslider.servingSize)return(new Image).src=t.imagoslider.assets[n].serving_url+t.imagoslider.servingSize},t.getLast=function(){return Number(t.imagoslider.length)-1},t.getCurrent=function(){return t.currentIndex},t.imagoslider.setCurrent=function(e){return t.action=function(){switch(!1){case!(0===e&&t.currentIndex===parseInt(this.length)-1&&!this.conf.siblings):return"next";case!(e===parseInt(this.length)-1&&0===t.currentIndex&&!this.conf.siblings):return"prev";case!(e>t.currentIndex):return"next";case!(e<t.currentIndex):return"prev";default:return""}}.call(this),void 0===e?this.goNext():(t.currentIndex=e,c.$emit(this.conf.namespace+":changed",e))},_.isUndefined(e.autoplay)||t.$watch(e.autoplay,function(e){return 0<parseInt(e)?t.imagoslider.conf.interval=d(function(){return t.imagoslider.goNext("",!1)},parseInt(e)):t.clearInterval()}),a=function(e){switch(e.keyCode){case 37:return t.$apply(function(){return t.imagoslider.goPrev()});case 39:return t.$apply(function(){return t.imagoslider.goNext()})}},t.imagoslider.conf.enablekeys&&g.on("keydown",a),(l=[]).push(c.$on(t.imagoslider.conf.namespace+":change",function(e,n){return t.clearInterval(),t.imagoslider.setCurrent(n)})),t.$on("$destroy",function(){var e,n,r,i;for(g.off("keydown",a),t.clearInterval(),r=[],e=0,n=l.length;e<n;e++)i=l[e],r.push(i());return r})}}},n=function(n){var r;this.conf={animation:"fade",enablekeys:!0,enablearrows:!0,loop:!0,current:0,namespace:"slider",autoplay:0,next:null,prev:null,prefetch:!0},this.setServingSize=(r=this,function(e){return r.servingSize?r.servingSize=e:(r.servingSize=e,n.prefetch("initial"))})};angular.module("imago").directive("imagoSlider",["$rootScope","$document","$interval","$location",e]).controller("imagoSliderController",["$scope",n])}.call(this),angular.module("imago").run(["$templateCache",function(e){e.put("/imago/imago-slider.html",'<div ng-class="[imagoslider.conf.animation, action]" ng-swipe-left="imagoslider.goNext($event)" ng-swipe-right="imagoslider.goPrev($event)" class="imago-slider-content"><div ng-show="imagoslider.conf.enablearrows &amp;&amp; (imagoslider.length &gt; 1 || imagoslider.conf.siblings)" ng-click="imagoslider.goPrev($event)" analytics-on="click" analytics-event="Previous Slide" class="prev"></div><div ng-show="imagoslider.conf.enablearrows &amp;&amp; (imagoslider.length &gt; 1 || imagoslider.conf.siblings)" ng-click="imagoslider.goNext($event)" analytics-on="click" analytics-event="Next Slide" class="next"></div></div>')}]);