.imago-field.currency(ng-class="{expanded: input.expanded}")
  button.ii.ii-caret-left(
    ng-click="input.expanded = !input.expanded"
    )
  .fields
    .wrapper.compact(
      ng-if="!input.expanded"
      ng-class="{focus:onfocus}"
      )
      label
        span(
          ng-repeat="cur in currencies"
          ng-click="currency = cur"
          ng-class="{active: currency === cur, invalid: notComplete[cur]}") {{cur}}
      input(
        type="text"
        imago-filter-currency
        ng-model="ngModel[currency]"
        ng-model-options="{updateOn: 'blur'}"
        ng-change="update(ngModel); onfocus = false"
        ng-disabled="!currency"
        ng-focus="onfocus = true"
      )

    .wrapper.expanded(
      ng-repeat="cur in currencies"
      ng-if="input.expanded"
      ng-class="{invalid: notComplete[cur]}"
      )

      .imago-field
        label {{cur}}
        input(type="text"
          currency="{{cur}}"
          imago-filter-currency
          ng-model="ngModel[cur]"
          ng-focus="onFocus(input)"
          ng-blur="unbindSave(input); saveOnBlur(input);"
          )
